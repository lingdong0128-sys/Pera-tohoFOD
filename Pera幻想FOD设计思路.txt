那么开始吧，关于Pera幻想POF
我们简称他为幻想POF吧
关于游戏思路设计
关于地图设计
	我们将大地图作为区块分级
	然后将小地图作为每个房间分级
	然后的话大区块就是地牢区块
	根据主线的推进，其他的区块就逐渐被并入地牢区块
	具体的话是体现在map.json中，就是为每个字典下新增一个腐化键，根据判定腐化是否为真来完成吞噬
	也就是被吞并了，所以原本的区域就不复存在了这样
	然后就是原本的地图可以抄tw的地图
关于地牢区块设计
	作为肉鸽地牢，我们这样子设计
	地牢里面存储的是房间类型的编号，也就是每个编号对应着不同的房间类型
	这个我们就新增一个csv的全局变量来实现
	然后的话要对start事件进行更改
	就是进去的时候根据当前的场景决定用什么东西
	也就是说地图是否腐化的属性和角色现在在哪里很重要
	然后就是关于大家的设定，每个角色都应该有自己的想法或者什么然后会自己去探索地牢，这个时候就要看角色ai设计了，这个我们放到后面去说
	然后就是每次地牢的生成随机性
	随机性怎么实现？我们再加一个字典
	地牢房间信息怎么存
	我们知道地牢的房间之间肯定是有不同的通道去连通的
	所以说我们只要让每一个房间知道他边上的房间是什么就好了
	然后这个就从已经有的房间类型列表里面去选
	那么地牢结构的字典应该是这样构建的
dungeon_graph = {
    # === 房间 1 (起点) ===
    "1001": { 
        "name": "阴暗的入口",
        "type": "安全区",
	'music':'xxx',
        # 核心：这里直接记下隔壁房间的身份证号(ID)
        "exits": {
            "前": "1002", 
            "后": None, 
            "左": None
        } 
    },

    # === 房间 2 (走廊) ===
    "1002": {
        "name": "长满青苔的走廊",
        "type": "战斗",
        "exits": {
            "前": "1003", 
            # 关键：这里直接指回 1001，这就形成了通路
            "后": "1001"  
        }
    },

    # === 房间 3 (宝箱) ===
    "1003": {
        "name": "宝物库",
        "type": "宝箱",
	'music':'xxx',
        "exits": {
            "后": "1002"
        }
    }
}
	这个应该在你进入地牢这个区块的时候随机生成的一个字典
	然后就是关于房间类型
	地牢刚开始的时候的房间类型是少的
	但是每随着主线剧情的推进，地牢吞并的区块越多
	地牢解锁的房间类型就更多
//[2025/12/17-1:34]结束记录//
关于角色ai机
	到底要不要让角色之间有着如同玩家一般的互动机制？
	
关于地图切换
    也就是说我们的地牢逻辑就走平面网图
    我们的大地图就走大富翁形式
[2025/12/19-23:22]
    以下是关于东方POF的一些游戏思路总结
    游戏流程是这样的，main.py->start.py
    数据初始化(做了一半，待更新)
        地牢怪物初始化加入（没做）
        异常状态初始化加入（全局变量，应该和其他的全局变量一样其他功能里面都应该可以用，没做）
        地牢数据相关初始化（比如说地牢进入次数之类的没做）
        花销数据初始化(没做)
    任务系统初始化（没做）
        从全局变量的任务.csv下面去拿，是否完成什么的所以这个要放进存档
        初始化所有主线，支线，角色任务
        任务栏输出事件
        任务接取完成和判定事件
    start.py调用master选择事件,会存入存档的系统设置，当前存档是否已经选择过主角的(数据待添加)->选择你的主角（默认自定义）
    如果是自定义角色则进入角色自定义事件
    定义角色的base-cflag之类的
    master选择完之后进入立绘选择（不选择默认初始绘）
    立绘选择完进行口上选择(没有口上采用默认口上),目前数据中没有当前角色的口上类型的键值对，需要添加，口上选择作为单独事件存在，可以在后续游戏中的稳定事件中调用
    口上选择完之后进行难度选择
    难度选择会从怪物.csv这个全局变量中取数值并字典化然后根据难度进行更改（怪物.csv源数据为定义，数据加到列表里面的操作也还没做），同口上
    进行游戏初剧情播放（事件还没搓）
    根据所选角色进行对应角色的游戏初剧情播放（作为口上差分存在，还没做）
    角色位置放置（把角色放置进他初始位置对于的地图id的位置）
    初会面判定
    进入主游戏菜单（未健全）
    第一个任务是于间隙中的幻想乡大会（没做）
        幻想乡大会事件，主要用于展示现状并且做出角色实力在地牢被压制的事实，然后发布探索任务
        角色没经过幻想乡大会就进入地牢，会降信任，并且幻想乡大会任务标记为失败
    开始游戏主流程
    地牢外
        紧张的幻想乡生活，于悠闲悠哉的状态不同，大家都有着自己要做的事情，也会主动去探索地牢，这里需要先实现角色ai机（没做）
        你可以和其他角色交互来增加好感信赖之类的，陷落达到朋友阶段就可以带入地牢（没做）
        具体展示为让她和你带着一起，然后前往地牢（没做）
    地牢内
        地牢数据初始化
            随机房间
            角色数值地牢化（没做）
        地牢探索，地牢内应该有每个房间的音乐什么的，然后有地牢的行动逻辑（不健全）
        地牢战斗，地牢战斗，通过地牢化的数值和各种技能和怪物对波吧！（没做）
        地牢搜索(做一半)
        地牢商店（没做）
    角色ai机（没做）
        准备采用花销制度，根据每个角色的基础值计算其每天花销，然后每个操作的花销需要存储在一个新的全局变量下
        每次master执行操作的时候，角色们也会进行行动计算，根据当前花销计算当前花销最小的行为是什么
        花销控制
            这个应该广泛的用到各种地方
            根据角色当前状态？天气？对别的角色的相性？进行花销控制，实现动态改变花销
        也就是说角色也可以和真人一样行动了
    当日结算（没做，待定）
        正常来说角色在自宅时可以提供进入下一天选项，如果时间判定到睡眠时间了，才会出现
        睡眠时间通过角色的起床时间和角色的就寝时间，一般为起床时间+14小时，如果判定当前时间为起床时间+16小时进入要睡觉状态
        要睡觉状态所有行动的精力啊什么的别的花销都会*2
        如果判定当前时间为起床时间+20小时就会晕厥，角色晕厥后第二天不会出现在自宅并且体力和精力只有上限的50%，晕厥的角色不受起床时间的控制而是会在晕厥时间+常规睡眠时间的时候醒来
        如果晕厥的地点是什么特殊的地方的话可能还会触发特殊口上之类的
        关于当日结算后的其他角色
        其他角色的判定也是这样，不过这些的逻辑要用花销控制来实现就是了（上面要用到的时间系统从角色的cflag里面拿就好了）
    主线机制（没做）
        主线剧情根据天数进行计算，每天结算之时根据当前的各种付出和收获进行主线剧情判定，来决定主线剧情往什么方向去推动
    日期推断（没做）
        当日结算一次后增加一
    天气系统（没做）
        每天从天气列表中觉得天气和天气持续时间，然后特殊地点触发特殊天气
[2025/12/20-20:13]
    关于数据，应该是类似于那种爬塔游戏一样的数据吧，体力值，护盾值，行动值，防御，攻击
        然后的话有技能释放消耗，灵力，妖力，魔力，精力
        然后的话就是同行特技，这个写在角色差分内
    关于异常状态数据的读取化和使用化
        需要一个异常状态处理，读取异常状态第三列的数据，然后解析源数据进行其他数据加减值计算
        这个事件应该在地牢内的每个回合都进行异常状态判定，如果有异常状态就进行异常状态处理
        如果没有就跳过处理
        然后就给每个角色上一个异常状态的键
    然后关于角色ai自机的那么一个动作，为了减少程序的输出什么的角色在地牢内的行为应该更加严格的控制
        比如说就是在地牢内游荡然后和怪物对战就是纯粹的比数值，数值低就陷入求助状态数值高就把怪物踹死并减少数值
        这样子就保证就可玩性，不会说在地牢里面逛半天遇不到人和角色求助事件难以触发这种事情
    结算机制
        在主角结算前各个角色的花销系统控制什么的都是可以正常运行的
        但是角色结算之后呢？我们不可能让每个角色都在主角结算之后也都根据一次一次的这种进行花销计算
        这个应该怎么办呢？
        而且用花销的话不同事情的时间控制怎么办？
        我们把时间拆分成基础时间单位，比如说一个基础时间单位的消耗，然后把一个基础时间单位的消耗看作是一次时间迭代，也就是说假设说主角在做一个很花时间的事情，就会根据时间消耗和基础时间消耗的计算来判断需要执行多少个回合（也就是说其他角色可以做什么事）
        也就是说主角结算的时候就相当于这个事件会消耗主角睡着时间的时间单位，这样子就可以做到让主角睡着的时候其他角色也能活动了
        这里的话我把地牢的结算机制也说一下吧
        地牢的话是回合制的结算机制，回合开始时读取各种状态，回合结束时进行状态结算
        然后的话去拿上下文就是每个回合更新一次上下文读取，然后仅对当前回合的数据进行操作，操作完之后再同步到全数据
[2025/12/21-11:55]
    更改了init的获取方式，现在不会在init里面给什么csv数据特殊照顾了，所有大于两列的数据后面的会被放进和id键值对的列表里面，然后再写数据整理事件
    具体参照初始化事件里面的Item初始化